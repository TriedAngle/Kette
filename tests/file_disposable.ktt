Module open: 'Test::FileDisposable.
Module use: 'System.

f := File open: "core/init.ktt" Flags: Posix O_RDONLY Mode: 0.
preview := f using: [ | file |
    file eachLine: [ | line | None ] First: 3.
    file readFirstLines: 3
].
firstDisposed := f disposed.

f2 := File open: "core/init.ktt" Flags: Posix O_RDONLY Mode: 0.
stats := f2 using: [ | file | { size = file size. stat = file statSize } ].

stats size toString println.
stats stat toString println.
preview length toString println.
"file-disposable: ok" println.
